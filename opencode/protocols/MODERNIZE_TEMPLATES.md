# Modernize Artifact Templates

Use these templates for `/run-modernize` outputs to keep structure consistent.
See `opencode/protocols/MODERNIZE_EXAMPLE.md` for a concrete example.

All artifacts follow a **Source-to-Target migration model**:
- **Source Project (A):** The legacy system being analyzed (read-only).
- **Target Project (B):** The new project where the modernized system will be built.

## Format Requirements

Every artifact MUST be human-readable and include:
1. **Executive Summary** (2-3 sentences at the very top)
2. **Table of Contents** (linked section list)
3. **Section Numbering** (1, 1.1, 1.2, ...)
4. **Narrative Prose** (not just headers — every section must have substantive text)
5. **Source/Target References** (every artifact must reference both project paths)

If a section is not applicable, write `N/A` with a short reason.

> **Note:** Paths below show the default `.pipeline-output/` convention. When `--output-dir` is used, substitute accordingly.

---

## .pipeline-output/modernize/modernize-index.md

> Navigation page produced by Stage 3 (Synthesis). NOT an artifact task — generated by the orchestrator.

```markdown
# Modernization Plan — <project name>

Source: <source project path>
Target: <target project path>

## Documents

1. [Source Assessment](modernize-source-assessment.md) — Current state analysis of project A
2. [Target Design](modernize-target-design.md) — Architecture and structure of project B
3. [Migration Strategy](modernize-migration-strategy.md) — How to build B while A runs
4. [Migration Roadmap](modernize-migration-roadmap.md) — Timeline, phases, and milestones
5. [Migration Risks](modernize-migration-risks.md) — Risk register and governance

## Key Decisions
<Bullet list>

## Open Questions
<Bullet list>

## Next Steps
<Recommendations for /run-pipeline in the target project>
```

---

## .pipeline-output/modernize/modernize-source-assessment.md

**Executive Summary**
<2-3 sentences summarizing the current state of project A and its migration readiness.>

**Table of Contents**
1. Source Project Overview
2. Architecture Snapshot
3. Key Dependencies
4. Operational Pain Points
5. Performance Bottlenecks
6. Security & Compliance Gaps
7. Technical Debt Inventory
8. Migration Readiness Score
9. Risks
10. Open Questions

### 1. Source Project Overview
<Project path, language/framework, team size, age, deployment model.>

### 2. Architecture Snapshot
<High-level architecture description. Describe layers, services, data flow.>

### 3. Key Dependencies
<External services, libraries, infrastructure dependencies. Version constraints.>

### 4. Operational Pain Points
<What causes friction in development, deployment, or operations.>

### 5. Performance Bottlenecks
<Known performance issues, scaling limits, resource constraints.>

### 6. Security & Compliance Gaps
<Known vulnerabilities, compliance requirements not met, outdated dependencies.>

### 7. Technical Debt Inventory
<Categorized list of tech debt items with estimated severity (high/medium/low).>

### 8. Migration Readiness Score
<Per-component readiness assessment: high/medium/low. Which parts are easiest to migrate first.>

### 9. Risks
<Risks specific to understanding or analyzing the source system.>

### 10. Open Questions
<What needs clarification before proceeding.>

---

## .pipeline-output/modernize/modernize-target-design.md

**Executive Summary**
<2-3 sentences describing the target project B — what it will look like and the key architectural choices.>

**Table of Contents**
1. Target Project Overview
2. Target Architecture
3. Directory Layout
4. Tech Stack Choices
5. Non-Functional Goals
6. Modularity Strategy
7. Data Strategy
8. Observability Strategy
9. API Contract with Source (During Migration)
10. Key Tradeoffs
11. Open Questions

### 1. Target Project Overview
<Project path, name, relationship to source project A.>

### 2. Target Architecture
<High-level architecture of project B. Layers, services, data flow.>

### 3. Directory Layout
<Proposed directory structure for the target project.>

### 4. Tech Stack Choices
<Language, framework, database, infrastructure choices and rationale.>

### 5. Non-Functional Goals
<Performance targets, scalability requirements, reliability SLAs.>

### 6. Modularity Strategy
<How the system is decomposed. Service boundaries, module boundaries.>

### 7. Data Strategy
<Database design direction, data migration approach, dual-write considerations.>

### 8. Observability Strategy
<Logging, monitoring, alerting, tracing approach for project B.>

### 9. API Contract with Source (During Migration)
<How A and B communicate during the parallel-run period. Compatibility layer, shared interfaces.>

### 10. Key Tradeoffs
<Major tradeoffs made in the target design and their rationale.>

### 11. Open Questions
<Decisions that need stakeholder input.>

---

## .pipeline-output/modernize/modernize-migration-strategy.md

**Executive Summary**
<2-3 sentences on the chosen migration approach — strangler fig, big bang, or incremental — and why.>

**Table of Contents**
1. Migration Approach
2. Strangler Fig Boundaries
3. Parallel-Run Strategy
4. Data Migration Plan
5. Backward Compatibility
6. Cutover Criteria
7. Rollback Plan
8. Dependencies Sequencing
9. Risk Mitigations
10. Open Questions

### 1. Migration Approach
<Refactor vs. rewrite decision. Chosen strategy and rationale.>

### 2. Strangler Fig Boundaries
<Which components/routes/services get migrated first. How traffic is split between A and B.>

### 3. Parallel-Run Strategy
<How A and B run simultaneously. Traffic routing, feature flags, shadow mode.>

### 4. Data Migration Plan
<How data moves from A to B. Dual-write, ETL, event sourcing, or snapshot approaches.>

### 5. Backward Compatibility
<What compatibility guarantees exist during migration. API versioning, shared schemas.>

### 6. Cutover Criteria
<Measurable criteria for when a component can be cut over from A to B.>

### 7. Rollback Plan
<How to roll back to A if B fails. Per-component and full-system rollback.>

### 8. Dependencies Sequencing
<Order of component migration based on coupling and risk.>

### 9. Risk Mitigations
<Strategy-level risk mitigations.>

### 10. Open Questions
<Strategy decisions requiring more information.>

---

## .pipeline-output/modernize/modernize-migration-roadmap.md

**Executive Summary**
<2-3 sentences on the timeline — how many phases, estimated duration, key milestones.>

**Table of Contents**
1. Phase Overview
2. Phase 0: Target Scaffold
3. Phase 1–N: Component Migration
4. Cutover Phase
5. Parallel-Run Period
6. Decommission Plan for Source
7. Milestones
8. Dependencies
9. Exit Criteria
10. Open Questions

### 1. Phase Overview
<High-level timeline with phases and estimated durations.>

### 2. Phase 0: Target Scaffold
<Initial setup of project B — repo creation, CI/CD, base infrastructure.>

### 3. Phase 1–N: Component Migration
<Per-phase breakdown. Which components move in which phase, deliverables, acceptance criteria.>

### 4. Cutover Phase
<Final migration phase — traffic switch, DNS, database cutover.>

### 5. Parallel-Run Period
<Duration and exit criteria for running A and B simultaneously.>

### 6. Decommission Plan for Source
<How project A is shut down after full cutover. Data archival, DNS teardown, team transition.>

### 7. Milestones
<Key milestone dates/triggers.>

### 8. Dependencies
<Cross-team or external dependencies that affect the timeline.>

### 9. Exit Criteria
<What defines "done" for the entire modernization.>

### 10. Open Questions
<Timeline uncertainties.>

---

## .pipeline-output/modernize/modernize-migration-risks.md

**Executive Summary**
<2-3 sentences on the top risks and the governance model for managing them.>

**Table of Contents**
1. Risk Register
2. Dual-System Risks
3. Data Consistency Risks
4. Cutover Risks
5. Rollback Scenarios
6. Operational Risks
7. Security Risks
8. Mitigations
9. Governance Model
10. Open Questions

### 1. Risk Register
<Table: Risk ID, Description, Likelihood, Impact, Mitigation, Owner.>

### 2. Dual-System Risks
<Risks from running A and B simultaneously — drift, inconsistency, operational overhead.>

### 3. Data Consistency Risks
<Risks from data existing in both systems — conflicts, stale reads, replication lag.>

### 4. Cutover Risks
<Risks during the final switch — downtime, data loss, rollback failure.>

### 5. Rollback Scenarios
<Specific scenarios where rollback is needed and how each is handled.>

### 6. Operational Risks
<Team capacity, knowledge gaps, tooling gaps, infrastructure risks.>

### 7. Security Risks
<New attack surfaces, credential management across two systems, compliance gaps.>

### 8. Mitigations
<Consolidated mitigation plan for the highest-impact risks.>

### 9. Governance Model
<Decision-making process, escalation paths, review cadence, stakeholder communication.>

### 10. Open Questions
<Risk-related unknowns.>
